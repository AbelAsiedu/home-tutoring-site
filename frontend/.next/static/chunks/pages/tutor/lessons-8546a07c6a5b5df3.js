(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[992],{4161:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutor/lessons",function(){return s(3600)}])},1842:function(e,t,s){"use strict";async function safeFetchJson(e,t){try{let s=await fetch(e,Object.assign({credentials:"include"},t||{}));if(!s.ok){let e=await s.text().catch(()=>null),t=Error("HTTP "+s.status+" "+s.statusText);throw t.status=s.status,t.body=e,t}return await s.json()}catch(t){throw console.error("API fetch error",e,t),t}}s.d(t,{S:function(){return swrFetcher}});let swrFetcher=e=>safeFetchJson(e)},3600:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return TutorLessons}});var n=s(5893),r=s(9734),o=s(3454),i=s(9044),a=s(1842),l=s(7294);function TutorLessons(){let{data:e,mutate:t}=(0,r.ZP)("/api/lessons",a.S),[s,c]=(0,l.useState)(null);async function open(e){let t=await fetch("/api/lessons/".concat(e),{credentials:"include"});if(!t.ok)return alert("Could not load lesson");let s=await t.json();c(s)}async function submitReport(e){e.preventDefault();let n=e.target,r=new FormData(n),o={summary:r.get("summary"),homework:r.get("homework"),progress_score:r.get("progress_score")},i=await fetch("/api/lessons/".concat(s.lesson.id,"/report"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),credentials:"include"});if(!i.ok)return alert("Error submitting report");alert("Report submitted"),n.reset(),t()}async function uploadRecording(e){e.preventDefault();let n=e.target,r=new FormData(n),o=await fetch("/api/lessons/".concat(s.lesson.id,"/recording"),{method:"POST",body:r,credentials:"include"});if(!o.ok)return alert("Upload failed");alert("Recording uploaded"),n.reset(),t()}return(0,n.jsxs)("div",{children:[(0,n.jsx)(o.Z,{}),(0,n.jsxs)("main",{className:"container",children:[(0,n.jsx)("h1",{children:"Your lessons"}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(240px,1fr))",gap:12},children:e?e.map(e=>(0,n.jsxs)("div",{className:"card glass",style:{padding:12},children:[(0,n.jsx)("div",{children:(0,n.jsx)("strong",{children:new Date(e.scheduled_at).toLocaleString()})}),(0,n.jsxs)("div",{className:"muted",children:["Student: ",e.student_id||"â€”"]}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("button",{className:"btn",onClick:()=>open(e.id),children:"Open"})})]},e.id)):(0,n.jsx)("div",{children:"Loading lessons..."})}),s&&(0,n.jsxs)("section",{style:{marginTop:18},children:[(0,n.jsxs)("h2",{children:["Lesson: ",new Date(s.lesson.scheduled_at).toLocaleString()]}),(0,n.jsxs)("div",{className:"card glass",style:{padding:12},children:[(0,n.jsx)("h4",{children:"Post report"}),(0,n.jsxs)("form",{onSubmit:submitReport,children:[(0,n.jsx)("textarea",{name:"summary",placeholder:"Summary",required:!0,style:{width:"100%",minHeight:80}}),(0,n.jsx)("input",{name:"homework",placeholder:"Homework",style:{width:"100%",marginTop:8}}),(0,n.jsx)("input",{name:"progress_score",placeholder:"Score (0-10)",style:{width:160,marginTop:8}}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("button",{className:"btn",children:"Submit report"})})]}),(0,n.jsx)("h4",{style:{marginTop:12},children:"Upload recording"}),(0,n.jsxs)("form",{onSubmit:uploadRecording,encType:"multipart/form-data",children:[(0,n.jsx)("input",{type:"file",name:"recording",accept:"audio/*,video/*",required:!0}),(0,n.jsx)("input",{name:"notes",placeholder:"Notes",style:{width:"100%",marginTop:8}}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("button",{className:"btn",children:"Upload"})})]})]})]})]}),(0,n.jsx)(i.Z,{})]})}}},function(e){e.O(0,[664,133,997,774,888,179],function(){return e(e.s=4161)}),_N_E=e.O()}]);