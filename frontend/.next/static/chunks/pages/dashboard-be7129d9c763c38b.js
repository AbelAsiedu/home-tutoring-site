(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return n(3599)}])},1842:function(s,e,n){"use strict";async function safeFetchJson(s,e){try{let n=await fetch(s,Object.assign({credentials:"include"},e||{}));if(!n.ok){let s=await n.text().catch(()=>null),e=Error("HTTP "+n.status+" "+n.statusText);throw e.status=n.status,e.body=s,e}return await n.json()}catch(e){throw console.error("API fetch error",s,e),e}}n.d(e,{S:function(){return swrFetcher}});let swrFetcher=s=>safeFetchJson(s)},3599:function(s,e,n){"use strict";n.r(e),n.d(e,{default:function(){return Dashboard}});var i=n(5893),r=n(9734),d=n(3454),t=n(9044),c=n(1842),a=n(7294);function Dashboard(){let{data:s,error:e}=(0,r.ZP)("/api/dashboard",c.S),{data:n}=(0,r.ZP)("/api/lessons",c.S),[l,o]=(0,a.useState)(null);async function viewLesson(s){let e=await fetch("/api/lessons/".concat(s),{credentials:"include"});if(!e.ok)return alert("Could not load lesson");let n=await e.json();o(n)}return e?(0,i.jsxs)("div",{children:[(0,i.jsx)(d.Z,{}),(0,i.jsx)("main",{className:"container",children:(0,i.jsx)("p",{className:"muted",children:"Could not load dashboard."})}),(0,i.jsx)(t.Z,{})]}):s?(0,i.jsxs)("div",{children:[(0,i.jsx)(d.Z,{}),(0,i.jsxs)("main",{className:"container",children:[(0,i.jsx)("h1",{children:"Your dashboard"}),(0,i.jsxs)("section",{style:{marginTop:18},children:[(0,i.jsx)("h2",{children:"Upcoming lessons"}),s.upcoming&&s.upcoming.length?(0,i.jsx)("div",{className:"product-grid",children:s.upcoming.map(s=>(0,i.jsxs)("div",{className:"card glass",style:{padding:12},children:[(0,i.jsx)("div",{children:(0,i.jsx)("strong",{children:new Date(s.scheduled_at).toLocaleString()})}),(0,i.jsxs)("div",{className:"muted",children:["Duration: ",s.duration_minutes," mins"]}),(0,i.jsx)("div",{style:{marginTop:8},children:(0,i.jsx)("button",{className:"btn",onClick:()=>viewLesson(s.id),children:"View"})})]},s.id))}):(0,i.jsx)("div",{className:"muted",children:"No upcoming lessons."})]}),(0,i.jsxs)("section",{style:{marginTop:18},children:[(0,i.jsx)("h2",{children:"Recent reports"}),s.recentReports&&s.recentReports.length?(0,i.jsx)("div",{className:"product-grid",children:s.recentReports.map(s=>(0,i.jsxs)("div",{className:"card glass",style:{padding:12},children:[(0,i.jsx)("div",{children:(0,i.jsx)("strong",{children:new Date(s.created_at).toLocaleString()})}),(0,i.jsxs)("div",{className:"muted",children:["Score: ",s.progress_score||"â€”"]}),(0,i.jsx)("div",{style:{marginTop:8},children:s.summary})]},s.id))}):(0,i.jsx)("div",{className:"muted",children:"No reports yet."})]}),(0,i.jsxs)("section",{style:{marginTop:18},children:[(0,i.jsx)("h2",{children:"Recent recordings"}),s.recentRecordings&&s.recentRecordings.length?(0,i.jsx)("div",{className:"product-grid",children:s.recentRecordings.map(s=>(0,i.jsxs)("div",{className:"card glass",style:{padding:12},children:[(0,i.jsxs)("div",{className:"muted",children:["Uploaded: ",new Date(s.uploaded_at).toLocaleString()]}),s.url?(0,i.jsx)("audio",{controls:!0,src:s.url,style:{width:"100%",marginTop:8}}):(0,i.jsx)("div",{className:"muted",children:"No recording file available"}),(0,i.jsx)("div",{style:{marginTop:8},children:s.notes})]},s.id))}):(0,i.jsx)("div",{className:"muted",children:"No recordings yet."})]}),l&&(0,i.jsxs)("section",{style:{marginTop:18},children:[(0,i.jsx)("h2",{children:"Lesson details"}),(0,i.jsxs)("div",{className:"card glass",style:{padding:12},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"When:"})," ",new Date(l.lesson.scheduled_at).toLocaleString()]}),(0,i.jsxs)("div",{className:"muted",children:["Status: ",l.lesson.status]}),(0,i.jsx)("h4",{style:{marginTop:8},children:"Reports"}),l.reports.length?l.reports.map(s=>(0,i.jsxs)("div",{style:{marginTop:8},className:"muted",children:[s.summary," ",(0,i.jsx)("div",{style:{fontSize:12},children:s.homework})]},s.id)):(0,i.jsx)("div",{className:"muted",children:"No reports"}),(0,i.jsx)("h4",{style:{marginTop:8},children:"Recordings"}),l.recordings.length?l.recordings.map(s=>(0,i.jsxs)("div",{style:{marginTop:8},children:[s.url?(0,i.jsx)("audio",{controls:!0,src:s.url,style:{width:"100%"}}):(0,i.jsx)("div",{className:"muted",children:"No file"}),(0,i.jsx)("div",{className:"muted",children:s.notes})]},s.id)):(0,i.jsx)("div",{className:"muted",children:"No recordings"})]})]})]}),(0,i.jsx)(t.Z,{})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)(d.Z,{}),(0,i.jsx)("main",{className:"container",children:(0,i.jsx)("p",{children:"Loading..."})}),(0,i.jsx)(t.Z,{})]})}}},function(s){s.O(0,[664,133,997,774,888,179],function(){return s(s.s=1075)}),_N_E=s.O()}]);