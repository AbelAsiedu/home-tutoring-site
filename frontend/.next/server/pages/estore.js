"use strict";(()=>{var e={};e.id=286,e.ids=[286,888,660],e.modules={6715:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>m,default:()=>u,getServerSideProps:()=>g,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>f,routeModule:()=>w,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>j,unstable_getStaticParams:()=>P,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>S});var a=r(7093),i=r(5244),o=r(1323),l=r(9209),c=r.n(l),n=r(9597),d=r(9668),p=e([d]);d=(p.then?(await p)():p)[0];let u=(0,o.l)(d,"default"),h=(0,o.l)(d,"getStaticProps"),x=(0,o.l)(d,"getStaticPaths"),g=(0,o.l)(d,"getServerSideProps"),m=(0,o.l)(d,"config"),f=(0,o.l)(d,"reportWebVitals"),S=(0,o.l)(d,"unstable_getStaticProps"),v=(0,o.l)(d,"unstable_getStaticPaths"),P=(0,o.l)(d,"unstable_getStaticParams"),b=(0,o.l)(d,"unstable_getServerProps"),j=(0,o.l)(d,"unstable_getServerSideProps"),w=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/estore",pathname:"/estore",bundlePath:"",filename:""},components:{App:n.default,Document:c()},userland:d});s()}catch(e){s(e)}})},1842:(e,t,r)=>{async function safeFetchJson(e,t){try{let r=await fetch(e,Object.assign({credentials:"include"},t||{}));if(!r.ok){let e=await r.text().catch(()=>null),t=Error("HTTP "+r.status+" "+r.statusText);throw t.status=r.status,t.body=e,t}return await r.json()}catch(t){throw console.error("API fetch error",e,t),t}}r.d(t,{S:()=>swrFetcher});let swrFetcher=e=>safeFetchJson(e)},9668:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>EStore,getServerSideProps:()=>getServerSideProps});var a=r(997),i=r(5941),o=r(1664),l=r.n(o),c=r(3454),n=r(9044),d=r(1842),p=e([i]);function EStore({initialProducts:e}){let{data:t,error:r}=(0,i.default)("/api/products",d.S,{fallbackData:e});async function addToCart(e){let t=new URLSearchParams({id:e});await fetch("/api/cart/add",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}),alert("Added to cart")}return(0,a.jsxs)("div",{children:[a.jsx(c.Z,{}),(0,a.jsxs)("main",{className:"container",children:[(0,a.jsxs)("div",{className:"glass",style:{padding:20,marginTop:18},children:[a.jsx("h1",{children:"E-Store â€” Books & Resources"}),a.jsx("p",{className:"muted",children:"Shop course books, revision guides and digital resources. Click a product to view details and purchase."})]}),a.jsx("section",{style:{marginTop:18},children:t&&t.length?a.jsx("div",{className:"product-grid",children:t.map(e=>(0,a.jsxs)("div",{className:"product glass",style:{display:"flex",flexDirection:"column"},children:[a.jsx("img",{src:e.image_path||e.image||"/images/book-placeholder.svg",alt:e.title,style:{width:"100%",height:180,objectFit:"cover"}}),(0,a.jsxs)("div",{style:{padding:"12px",flex:1,display:"flex",flexDirection:"column"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:700},children:e.title}),(0,a.jsxs)("div",{style:{fontSize:16,fontWeight:700},children:["GHS ",e.price]})]}),a.jsx("div",{className:"muted",style:{marginTop:8,flex:1},children:e.description||"No description available."}),(0,a.jsxs)("div",{style:{marginTop:12,display:"flex",gap:10},children:[a.jsx(l(),{href:`/product/${e.id}`,className:"btn",children:"View"}),a.jsx("button",{onClick:()=>addToCart(e.id),className:"btn",children:"Add to cart"})]})]})]},e.id))}):r?a.jsx("div",{className:"muted",children:"Could not load products (backend unreachable)"}):a.jsx("p",{children:"Loading..."})})]}),a.jsx(n.Z,{})]})}async function getServerSideProps(e){try{let{req:t}=e,r=t.headers["x-forwarded-proto"]||t.protocol||"http",s=t.headers["x-forwarded-host"]||t.headers.host||`localhost:${process.env.PORT||3001}`,a=`${r}://${s}`,i=await fetch(`${a}/api/products`),o=await i.json();return{props:{initialProducts:o}}}catch(e){try{let e=process.env.PORT||3001,t=await fetch(`http://localhost:${e}/api/products`),r=await t.json();return{props:{initialProducts:r}}}catch(e){return{props:{initialProducts:[]}}}}}i=(p.then?(await p)():p)[0],s()}catch(e){s(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},5941:e=>{e.exports=import("swr")},1017:e=>{e.exports=require("path")},7310:e=>{e.exports=require("url")}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[209,656,664,597,997],()=>__webpack_exec__(6715));module.exports=r})();